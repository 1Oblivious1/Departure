# Взаимодействие пользователя с заданиями:

1. **Получение списка всех заданий**
```http
GET /api/task
```
Ответ: список всех доступных заданий с их описанием и координатами.

2. **Начало выполнения задания**
```http
POST /api/task/start
Content-Type: application/json

{
    "userId": 1,        // ID пользователя
    "taskId": 1         // ID задания
}
```
Ответ: информация о начатом задании, включая `submissionId` - уникальный идентификатор выполнения.

3. **Завершение задания с фото**
```http
POST /api/task/complete
Content-Type: application/json

{
    "userId": 1,        // ID пользователя
    "taskId": 1,        // ID задания
    "photoUrl": "..."   // URL загруженной фотографии
}
```
Ответ: информация о завершенном задании.

4. **Просмотр заданий пользователя**
```http
GET /api/task/user/{userId}/tasks
```
Ответ: список заданий пользователя, отсортированный следующим образом:
- Сначала активные задания (статус `Pending`), новые сверху
- Затем выполненные задания (статус `Completed`), старые снизу

Каждое задание в ответе содержит:
```json
{
    "taskId": 1,                // ID задания
    "title": "Название",        // Название задания
    "description": "Описание",  // Описание задания
    "difficulty": 0,            // Сложность (0=Easy, 1=Medium, 2=Hard)
    "latitude": 55.7558,        // Широта места задания
    "longitude": 37.6173,       // Долгота места задания
    "submissionId": 1,          // ID выполнения
    "status": "Pending",        // Статус (Pending/Completed)
    "startedAt": "2024-04-21T...", // Время начала
    "endedAt": null,            // Время завершения (null для активных)
    "photoUrl": null            // URL фото (если задание завершено)
}
```

**Важные моменты для фронтенда:**
1. Перед началом задания нужно проверить, что у пользователя еще не начато это задание. Для этого использовать запрос, который вернет список ID заданий пользователя:
```http
GET /api/task/user/1/task-ids
```
Ответ будет в формате:
```json
{
    "activeTaskIds": [1, 3, 5],    // ID активных заданий
    "completedTaskIds": [2, 4]      // ID выполненных заданий
}
```
2. При завершении задания обязательно нужно прикрепить фото
3. Статусы заданий:
   - `Pending` - задание начато, но не завершено
   - `Completed` - задание успешно завершено
4. Сортировка заданий в списке пользователя уже реализована на бэкенде
5. Координаты заданий можно использовать для отображения на карте

**Рекомендуемый порядок действий на фронтенде:**
1. Показать список доступных заданий
2. При выборе задания:
   - Проверить наличие связи между пользователем и этим заданием
   - Если нет - разрешить начать новое
   - Если есть - показать предупреждение
3. При завершении задания:
   - Получить URL фото
   - Отправить запрос на завершение с URL
4. В профиле пользователя показывать список его заданий с учетом сортировки

---

# Взаимодействие пользователя с лентой новостей и с конкретным постом:

```http
GET /api/task/news
```
- Возвращает список всех постов
- Сортировка по времени начала выполнения задания (started_at)
- Каждый пост содержит информацию о задании, пользователе и комментариях

## Получение конкретного поста

```http
GET {{backend_HostAddress}}/api/post/1
```
Ответ будет в формате:
```json
{
    "idNewsFeed": 1,            // ID поста в ленте
    "description": "Описание",  // Описание поста
    "createdAt": "2024-04-21T...", // Время начала выполнения
    "likes": 5,                 // Количество лайков
    "idTaskSubmission": 1,      // ID выполнения задания
    "idUser": 0,                // бесполезное поле, здесь всегда будет возвращаться 0, игнорировать и не использовать
    "photoUrl": "url.jpg",      // URL фотографии
    "idTask": 1,                // ID задания
    "title": "Название",        // Название задания
    "taskDescription": "Описание", // Описание задания
    "difficulty": "Easy",       // Сложность (Easy/Medium/Hard)
    "latitude": 55.7558,        // Широта места задания
    "longitude": 37.6173,       // Долгота места задания
    "idUserProfilePublic": 1,   // ID публичного профиля
    "name": "Имя",              // Имя пользователя
    "avatarUrl": "example.com"  // Аватарка пользователя
    "comments": [               // Список комментариев
        {
            "idComment": 1,     // ID комментария
            "text": "Текст",    // Текст комментария
            "authorName": "Имя", // Имя автора
            "idUserProfilePublic": 1, // ID публичного профиля автора
            "avatarUrl": "example.com"  // Аватарка пользователя
            "submittedAt": "2024-04-21T..." // Время отправки
        }
    ]
}
```
- Возвращает полную информацию о посте по его ID
- Формат ответа идентичен формату поста в ленте новостей

## Добавление комментария
```http
POST /api/post/{id}/comment
Content-Type: application/json

{
    "userId": 1,
    "text": "Текст комментария"
}
```
- Добавляет новый комментарий к посту
- Возвращает обновленный пост с новым комментарием

## Лайк поста
```http
POST /api/post/{id}/like
```
- Увеличивает счетчик лайков на 1
- Возвращает обновленный пост

## Важные моменты:
1. Все запросы возвращают полную информацию о посте
2. Комментарии загружаются вместе с постами
3. Время создания поста берется из started_at в TaskSubmission
4. Имя пользователя берется из UserProfilePublic
5. Фотография хранится в TaskSubmission (photo_url)

---

# Достижения:

## Получение достижений пользователя
```http
GET {{backend_HostAddress}}/api/achievement/user/1
```
Ответ будет в формате:
```json
[
  {
    "idUserAchievement": 1,  // ID достижения в таблице достижений
    "name": "Первые шаги",   // Название достижения
    "points": 100            // Количество очков, получаемое пользователем за выполнение достижения
  }
]
```
- Возвращает список всех достижений, полученных пользователем

---